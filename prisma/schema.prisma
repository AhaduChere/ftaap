generator client {
  provider = "prisma-client"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  schemas  = ["auth", "public"]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Admin {
  admin_id                  BigInt   @id @default(autoincrement())
  teacher_id                BigInt?
  student_id                BigInt
  user_id                   String?  @db.Uuid
  Student                   Student  @relation(fields: [student_id], references: [student_id], onDelete: SetNull)
  Teacher                   Teacher? @relation(fields: [teacher_id], references: [teacher_id])
  users                     user?    @relation(fields: [user_id], references: [user_id], onDelete: Cascade)
  User_User_admin_idToAdmin user[]   @relation("User_admin_idToAdmin")

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Student {
  student_id                          BigInt              @id @default(autoincrement())
  teacher_id                          BigInt
  student_score_id                    BigInt?
  student_attendance_id               BigInt?
  student_fname                       String?             @default("") @db.VarChar
  student_lname                       String?             @default("") @db.VarChar
  student_program                     String?             @db.VarChar
  student_grade_level                 BigInt?
  is_archived                         Boolean?
  Admin                               Admin[]
  Student_Attendance                  Student_Attendance? @relation(fields: [student_attendance_id], references: [student_attendance_id])
  Student_Score                       Student_Score?      @relation(fields: [student_score_id], references: [student_score_id])
  Teacher                             Teacher             @relation(fields: [teacher_id], references: [teacher_id], onDelete: NoAction, onUpdate: NoAction)
  Teacher_Teacher_student_idToStudent Teacher[]           @relation("Teacher_student_idToStudent")

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Student_Attendance {
  student_attendance_id BigInt    @id @default(autoincrement())
  student_attended      Boolean
  inserted_date         DateTime? @db.Date
  Student               Student[]

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Student_Score {
  student_score_id            BigInt    @id @default(autoincrement())
  student_dibel_score         Float
  student_dibel_ORF           Float?
  student_dibel_MAZE          Float?
  student_fluency_score       Float?
  student_comprehension_score Float?
  student_vocab_score         Float?
  inserted_date               DateTime? @db.Date
  Student                     Student[]

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Teacher {
  teacher_id                          BigInt    @id @default(autoincrement())
  student_id                          BigInt?
  teacher_fname                       String    @default("") @db.VarChar
  teacher_lname                       String?   @default("") @db.VarChar
  user_id                             String?   @db.Uuid
  Admin                               Admin[]
  Student                             Student[]
  Student_Teacher_student_idToStudent Student?  @relation("Teacher_student_idToStudent", fields: [student_id], references: [student_id])
  users                               user?     @relation(fields: [user_id], references: [user_id], onDelete: Cascade)
  User_User_teacher_idToTeacher       user[]    @relation("User_teacher_idToTeacher")

  @@schema("public")
}

model User {
  user_id                          String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  role_id                          Int
  teacher_id                       BigInt?
  admin_id                         BigInt?
  email                            String?   @default("") @db.VarChar
  encrypted_password               String?   @default("") @db.VarChar
  username                         String?   @default("") @db.VarChar
  Admin                            Admin[]
  Teacher                          Teacher[]
  Admin_User_admin_idToAdmin       Admin?    @relation("User_admin_idToAdmin", fields: [admin_id], references: [admin_id])
  Role                             Role      @relation(fields: [role_id], references: [role_id], onDelete: SetNull)
  Teacher_User_teacher_idToTeacher Teacher?  @relation("User_teacher_idToTeacher", fields: [teacher_id], references: [teacher_id])

  @@schema("public")
}

model Role {
  role_id   Int    @id @default(autoincrement())
  role_name String @default("") @db.VarChar
  User      User[]

  @@schema("public")
}
